<meta HTTP-EQUIV="pragma" CONTENT="no-cache">

<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">

<meta HTTP-EQUIV="expires" CONTENT="0">

<script LANGUAGE="JavaScript">
if (external.menuArguments)
{
	var sel = '';
	var parentwin = external.menuArguments;
	var parentWin = external.menuArguments.window;
	var parentDoc = external.menuArguments.document;

	if(parentWin.getSelection)
	{
		sel = parentWin.getSelection();
	}
	else if(parentDoc.getSelection)
	{
		sel = parentDoc.getSelection();
	}
	else if(parentDoc.selection)
	{
		sel = parentDoc.selection.createRange().text;
	}
	
	var url = parentwin.location.href;
	var title = parentwin.document.title; 
	
	if (parentwin.event.srcElement.tagName == "A")
	{
		url = parentwin.event.srcElement.getAttribute("HREF");
		title = parentwin.event.srcElement.innerText;
	}

	var href=window.location.href
	var srcEvent = external.menuArguments.event;
	var EventElement = external.menuArguments.document.elementFromPoint ( srcEvent.clientX, srcEvent.clientY );
	if(href.substr(href.indexOf('?')+1)=='pic')//'IMG' == EventElement.tagName)
	{
		var url = EventElement.href;
		var title = external.menuArguments.document.title;
		var alt = EventElement.alt;
		var purl = external.menuArguments.location.href;
		var address='http://localhost:8080/add?type=pic&title='+escape(title)+'&url='+escape(url)+'&content='+escape(alt)+escape('\n¿¥‘¥£∫')+escape(purl);
	}
	else if(href.substr(href.indexOf('?')+1)=='note')
	{
		var address='http://localhost:8080/add?type=note&title='+escape(title)+'&url='+escape(url)+'&content='+escape(sel);
	}
	else
	{
		var address = 'http://localhost:8080/add?title='+escape(title)+'&url='+escape(url)+'&content='+escape(sel);
	}

	var parm = 'scrollbars=yes,width=650,height=500,left=75,top=20,status=no,resizable=no';
	var postwin = window.open( address, '_blank', parm);

	if( postwin )
	{
		// postwin.document.form1.title.value=title;
	}
}
</script>