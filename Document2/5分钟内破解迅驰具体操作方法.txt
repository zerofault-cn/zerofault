业内曝5分钟内破解迅驰具体操作方法 

--------------------------------------------------------------------------------
 
http://www.sina.com.cn 2006年09月19日 16:24 新浪科技 
 
　　编者按：最近，有媒体报道了无线局域网安全漏洞曝光的情况。在9月11日下午举行的无线局域网安全技术研讨会上，演示人员对迅驰笔记本电脑进行了安全测试，利用从网上下载的工具5分钟内破解了保护口令。在快速破解了迅驰无线网络密钥后，轻松连接到加密的无线局域网中，可获取合法用户的各种机密信息、电子邮件等，也能删除私密的文件、邮件，甚至传播电脑病毒。这一消息引起了广大网友的关注，究竟如何破解？相关专家发来一份整理出来的《迅驰密钥破解法》，详细介绍了破解的方法。

　　1、破解软件简介

　　WinAirCrackPack工具包是一款无线局域网扫描和密钥破解工具，主要包括airodump和aircrack等工具。它可以监视无线网络中传输的数据，收集数据包，并能计算出WEP/WPA密钥。

　　2、实验环境系统组成

　　2.1 硬件环境

　　选用具有WEP和WPA加密功能的无线路由器或AP一台

　　带有迅驰无线网卡的笔记本电脑两台(分别定义为STA1和STA2，作为合法无线接入用户)

　　抓包无线网卡一块

　　ü笔记本电脑一台(定义为STA3，作为入侵者)

　　2.2 软件环境

　　入侵者STA3 ：WinAirCrackPack工具包，

　　注意：STA3要开启在控制面板->管理工具->服务中开启Wireless Zero Config服务。

　　3、实验拓扑图

　　4、配置无线路由器(根据实际网络环境进行配置)

　　(1)STA1连接上无线路由器(默认未加密)。右键单击屏幕下的 图标，选择“查看可用的无线网络”，弹出如图1所示的窗口。 

　　其中显示有多个可用的无线网络，双击TP-LINK连接无线路由器，一会儿就连接成功。

　　(2)打开IE浏览器，输入IP地址：192.168.1.1(无线路由器默认局域网IP地址)。

　　(3)登录无线路由器管理界面(用户名：admin,密码：admin)。

　　单击界面左侧的“网络参数”下的“LAN口设置”选项，设置“IP地址”为192.168.1.8并保存，如图4所示。

　　(4)打开IE浏览器，输入IP地址：192.168.1.8，重新登录无线路由器管理界面(注意本实验选择TP-LINK无线路由器，其他品牌产品如CISCO等均有类似配置选项)，单击界面左侧的“无线设置”下的“基本设置”选项。

　　1)选择“模式”为“54Mbps(802.11g)”；

　　2)选择“密钥格式”为“ASCII码”；

　　3)选择“密钥类型”为“64位”；

　　4)设置“密钥1”为“pjwep”；

　　5)单击“保存”。

　  (5)当无线路由器设置好WEP密钥后，STA1需要重新连接上无线路由器(输入的密钥与无线路由器设置的密钥相同)，一会儿就连接成功。

　　(6)打开IE浏览器，输入IP地址：192.168.1.8，重新登录无线路由器管理界面，单击界面左侧的“DHCP服务器”下的“DHCP服务”选项，单击“不启用”并保存,如图8所示，单击“系统工具”下的“重启路由器”对路由器进行重启。

　　5、破解WEP、WPA密钥的软件下载

　　STA3从网上下载用于破解密钥的软件，具体操作步骤如下：

　　(1)在Google搜索页面中输入“WinAircrackPack下载”进行搜索，如图9所示。

　　点击上述页面中“安全焦点:安全工具-WinAircrackPack.zip”，弹出以下页面。

　  (2)单击“下载”保存该软件,可解压到本地磁盘的任何位置(以下我们解压到E盘根目录下为例)。

　　6、安装抓包无线网卡

　　注：用于抓包无线网卡的驱动采用Atheros v4.2.1(可从www.wildpackets.com/support/downloads/driver_download/1下载)，该卡必须采用Atheros AR5001, AR5002, AR5004, AR5005 或 AR5006芯片组，下表的网卡均可使用，本实验我们采用Netgear 的108M无线网卡(型号：WG511T)。

　　(1)在STA3笔记本上安装抓包无线网卡驱动。插入无线网卡，弹出如图11所示的窗口。选择“否，暂时不”，单击“下一步”。

　　(2) 选择“从列表或指定位置安装”，单击“下一步”。

　　(3)选择“不要搜索”，单击“下一步”。 

　　(4)单击“从磁盘安装”，在弹出的窗口中单击“浏览”，选择E:\WinAircrackPack\atheros421@(注：atheros421@可以从www.wildpackets.com/support/downloads/driver_download/1下载)目录下的net5211文件，单击“打开”，然后单击“确定”，单击“下一步”，在安装的过程中弹出如图15所示的窗口。

　　7、破解WEP密钥

　　(1)让STA1和STA2重新连接上无线路由器。

　　(2)在STA3笔记本电脑上运行airodump，该工具用来捕获数据包，按提示依次选择“16”:破解所用无线网卡的序号；

　　“a”，选择芯片类型，这里选择atheros芯片；

　　“6”，信道号，一般1、6、11是常用的信道号，选择“0”可以收集全部信道信息；

　　“testwep”(该输入文件名可任意)；

　　“y”，破解WEP时候选择“y”，破解WPA时选择“n”。

　　(3)回车后，进入以下界面。

　　(4)当该AP的通信数据流量极度频繁(比如可以采用STA1与STA2对拷文件来产生数据流量)，“Packets”所对应的数值增长速度就会越大。当大概抓到30万(如采用104位RC4加密需要抓到100万包)“Packets”时关闭airodump窗口，启动WinAircrack。

　　(5)点击左侧的“General”进行设置，选择加密类型为“WEP”，添加捕获的文件(testwep.ivs)。

　　(6)点击左侧的“Advanced”进行设置，选择“Aircrack”所在的位置。

　　(7)全部设置完后，点击右下角的“Aircrack the key”按钮弹出以下窗口。

　　(8)选择要破解网络的BSSID(本实验选择“1”)，回车得到最终WEP密钥。。

　　8、破解WPA密钥

　　(1)修改无线路由器的加密类型和加密方法，并设置为WPA-PSK认证和TKIP加密方式。

　　(2)在STA3笔记本上运行airodump，该工具用来捕获数据包，按提示依次选择“16”，“a”，“6”，“testwpa”(该输入文件名可任意)，“n”。

　　(3)回车后，进入以下界面

　　(4)让STA1重新连接上无线路由器，airodump将捕获一个无线路由器与STA1四次握手的过程。

　　(5)启动WinAircrack。

　　(6)点击左侧的“General”进行设置，选择加密类型为“WPA-PSK”，添加捕获的文件(testwpa.cap)。

　　(7)点击左侧的“Wpa”进行设置，选择一个字典文件(口令字典可下载：例如lastbit.com/dict.asp)。

　　(8)全部设置完后，点击右下角的“Aircrack the key”按钮弹出以下窗口，可知已经捕获到一次握手的过程。

　　(9)选择要破解网络的BSSID(本实验选择“2”)，回车后经过几分钟的计算，最终得到WPA密钥。

　　9、破解密钥后对网络的危害一例(伪造AP)

　　一旦入侵者知道了无线网络的WEP或WPA密钥，就可以连接到本地局域网内，这样入侵者就享有与正常接入用户一样对整个网络访问的权限，进行深度攻击。入侵者可以利用IPBOOK(www.skycn.com/soft/11014.html)、SuperScan(www.skycn.com/soft/8061.html)等类似这样的工具扫描局域网内的计算机，计算机里面的文件、目录、或者整个的硬盘驱动器能够被复制或删除，甚至其他更坏的情况诸如键盘记录、特洛伊木马、间谍程序或其他的恶意程序等等能够被安装到你的系统中，这样后果是非常严重的。

　　(1)简介

　　当WEP或WPA密码被破解后，入侵者可能用该密码和其他无线接入点(AP)构造一个假网络，当伪装AP的信号强于正常AP或用户靠近伪装AP时，正常用户会很自然的接入到该假网络中，对于用户本身来说是感觉不到该网络的，就在用户正常收发邮件时，我们可以用类似CAIN( www.ttian.net/website/2005/0908/458.html)这样的工具进行POP3、telnet等口令的破解等攻击。

　　(2)POP3口令破解

　　1)打开CAIN。

　　2)点击菜单栏“Configure”弹出以下窗口。

　　3)选择一个将用于抓包的网络适配器，点击“确定”，选择“ ”和“ ”，然后点击“ ”开始监控抓包。

　　4)正常用户开始收邮件，该软件可以对邮箱的登陆名和密码进行捕获。

　　(3)被破解后的危害

　　当黑客窃取了你的邮箱的用户名、密码、POP3服务器和SMTP服务器的IP地址后，就可以直接访问你的邮箱，你的邮件信息将完全暴露在黑客面前。 

 
